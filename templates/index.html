{% extends "base.html" %}
{% block title %}Login{% endblock %}
{% block content %}
  <h1>Posts</h1>
  {% if current_user.is_authenticated %}
    <p>Logged in as {{ current_user.username }} | <a href="{{ url_for('logout') }}">Logout</a></p>
    <p><a href="{{ url_for('new_post') }}">Create New Post</a></p>
  {% else %}
    <p><a href="{{ url_for('login') }}">Login</a> or <a href="{{ url_for('register') }}">Register</a></p>
  {% endif %}
  <hr>
  {% for post in posts %}
    <div>
      <p><strong>{{ post.author }}</strong> at {{ post.timestamp }}</p>
      <p>{{ post.content }}</p>
      <form action="{{ url_for('like', post_id=post.id) }}" method="post" style="display:inline;">
        <button type="submit">Like ({{ post.like_count }})</button>
      </form>
      <form action="{{ url_for('repost', post_id=post.id) }}" method="post" style="display:inline;">
        <button type="submit">Repost ({{ post.repost_count }})</button>
      </form>
      <hr>
    </div>
  {% endfor %}
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul>
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}
</body>
</html>
{% endblock %}

